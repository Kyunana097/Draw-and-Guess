# 你画我猜游戏 - 功能更新说明

## 新增功能

### 1. 房主游戏参数设置 ✅
在游戏房间中，房主可以设置以下游戏参数：
- **轮数**：游戏总共进行多少轮
- **每轮时间**：每轮游戏的时间限制（秒）
- **休息时间**：每轮结束后的休息时间（秒）

**使用方法**：
1. 创建房间后，在大厅界面下方可以看到游戏设置选项（仅房主可见）
2. 输入想要的参数值
3. 点击"应用设置"按钮确认

### 2. 绘画者选择与角色分配 ✅
游戏开始时会自动选择一名玩家作为绘画者：
- 系统会**全局播报**当前轮次的绘画者
- 每轮结束后自动轮换绘画者
- 只有绘画者能够：
  - 看到需要绘画的题目
  - 使用画板进行绘画
  - 控制下一轮的开始

### 3. 猜测与评分系统 ✅
游戏提供了灵活的评分机制：

#### 自动评分
- 玩家在聊天框输入猜测
- 如果猜测与题目**完全一致**，自动获得10分
- 系统会广播猜对的消息

#### 手动给分（绘画者）
- 绘画者可以根据玩家猜测的相似度手动给分
- 给分功能仅绘画者可用

#### 实时排行榜
- 游戏界面右侧显示实时得分排行
- 每轮结束后自动更新
- 绘画者会有特殊标记（🎨）

### 4. 游戏结束与最终排名 ✅
游戏完成所有轮次后：
- 自动显示**最终排名界面**
- 前三名有特殊的金银铜配色
- 显示每位玩家的得分
- 玩家可以点击"返回大厅"按钮回到房间

### 5. 房间聊天功能 ✅
在游戏大厅（游戏开始前）：
- 玩家可以在聊天面板中交流
- 支持实时消息同步
- 消息历史会保留在界面中

## 游戏流程

### 完整游戏流程：

1. **创建/加入房间**
   - 玩家从房间列表选择或创建房间
   - 进入大厅后可以聊天等待其他玩家

2. **游戏设置**（房主）
   - 房主设置游戏参数
   - 点击"开始游戏"启动

3. **游戏进行**
   - 系统选择绘画者并播报
   - 绘画者看到题目并开始绘画
   - 其他玩家在聊天框猜测
   - 猜对自动加分，或由绘画者手动给分

4. **轮次切换**
   - 绘画者点击"下一轮"按钮
   - 系统自动切换到下一位绘画者
   - 画布清空，新题目出现

5. **游戏结束**
   - 完成所有轮次后显示最终排名
   - 玩家确认后返回大厅
   - 可以再次开始新游戏

## 技术实现

### 服务器端改进
- 添加游戏配置管理（轮数、时间等）
- 实现词库系统，自动从文件加载题目
- 实现轮次管理和玩家轮换机制
- 自动计分系统
- 游戏结果计算与排名

### 客户端改进
- 动态UI：根据角色（房主/绘画者/普通玩家）显示不同功能
- 实时权限控制：只有绘画者可以绘画
- 题目显示：绘画者可见，其他玩家隐藏
- 游戏结果界面：美观的排名展示

### 消息协议扩展
新增消息类型：
- `MSG_SET_GAME_CONFIG`：设置游戏参数
- `MSG_GIVE_SCORE`：给玩家打分
- `MSG_NEXT_ROUND`：开始下一轮
- `MSG_GAME_RESULT`：游戏结果
- `guess_correct`：猜对通知

## 使用说明

### 启动游戏

#### 方法1：使用启动脚本（推荐）
```bash
./run_game.sh
```

#### 方法2：手动启动
```bash
# 终端1：启动服务器
cd server-deploy
python server.py

# 终端2：启动客户端
python -m src.client.main
```

### 配置文件

#### 词库文件
位置：`server-deploy/words.txt` 或 `data/words.txt`

可以自定义添加题目，每行一个词语。

## 注意事项

1. **网络连接**：确保客户端能连接到服务器（默认 127.0.0.1:5555）
2. **多人游戏**：建议至少2-3人游戏效果更好
3. **绘画权限**：非绘画者无法绘画，这是正常的游戏设计
4. **题目可见性**：只有绘画者能看到题目，其他人看到的是"隐藏"

## 更新日志

### v2.0.0 (2025-12-30)
- ✅ 实现房主游戏参数设置
- ✅ 实现绘画者选择和角色分配
- ✅ 实现猜测与评分系统
- ✅ 实现游戏结束与排名显示
- ✅ 为房间添加聊天功能

## 反馈与建议

如有问题或建议，欢迎提交 Issue 或 Pull Request。

祝游戏愉快！🎨🎮
